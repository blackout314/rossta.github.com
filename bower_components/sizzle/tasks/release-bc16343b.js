"use strict";var exec=require("child_process").exec;module.exports=function(e){var r=/(\d\.\d+\.\d+)-pre/;e.registerTask("release","Release a version of sizzle, updates a pre version to released, inserts `next` as the new pre version",function(s){if(!r.test(s))return void e.fatal("Next version should be a -pre version (x.x.x-pre): "+s);var i,t=e.config("pkg.version");return r.test(t)?(t=t.replace(r,"$1"),i=this.async(),void exec("git diff --quiet HEAD",function(r){return r?void e.fatal("The working directory should be clean when releasing. Commit or stash changes."):(e.task.run(["version:"+t,"tag:"+t,"version:"+s]),void i())})):void e.fatal("Existing version is not a pre version: "+t)})};